<script src="http://www.myersdaily.org/joseph/javascript/md5.js"></script>
<script>
    const sampleInput = 'hijkl';

    const inputToUse = sampleInput;

    let pathThusFar = ''; // append UDLR

    const width = 4;
    const height = 4;

    let currentX = 0;
    let currentY = 0;

    let blackListedPaths = [];

    function doorStatusHash(input, pathString) {
        console.log(input + pathString);
        return md5(input + pathString);
    }

    function doorIsOpen(character) {
        const char = character.toLowerCase();
        return char !== 'a' && !Number.isInteger(parseInt(character));
    }

    function statusUpDownLeftRightOpen(statusHash) {
        // Up, down, left, right
        const statusCharacters = statusHash.substr(0, 4);
        console.log('statusCharacters:', statusCharacters);
        return {
            up: doorIsOpen(statusCharacters[0]),
            down: doorIsOpen(statusCharacters[1]),
            left: doorIsOpen(statusCharacters[2]),
            right: doorIsOpen(statusCharacters[3]),
        };
    }

    function canWalkDirections(openDoorsStatus) {
        const validDirections = {
            total: 0,
            latestValid: null,
        };

        Object.keys(openDoorsStatus).forEach(direction => {
            // Direction only valid if inside maze
            if (
                currentX == 0 && direction === 'left' ||
                currentX === width && direction === 'right' ||
                currentY === 0 && direction === 'up' ||
                currentY === height && direction === 'down'
            ) {
                validDirections[direction] = false;
            } else {
                if (openDoorsStatus[direction]) {
                    validDirections.total++;
                    validDirections.latestValid = direction;
                }
                validDirections[direction] = openDoorsStatus[direction];
            }
        });

        return validDirections;
    }

    function chooseDirection(validDirections) {
        if (validDirections.down) return 'D';
        if (validDirections.right) return 'R';
        if (validDirections.left) return 'L';
        if (validDirections.up) return 'U';
    }

    for (let i = 0; i < 3; i++) {
        const currentStatusHash = doorStatusHash(inputToUse, pathThusFar);
        const openDoorsStatus = statusUpDownLeftRightOpen(currentStatusHash);
        const validDirections = canWalkDirections(openDoorsStatus);

        console.log('openDoorsStatus:', openDoorsStatus);
        console.log('validDirections:', validDirections);

        if (validDirections.total === 0) {
            // Blacklist and backtrack
        } else {
            let nextDirection = validDirections.latestValid[0].toUpperCase();
            if (validDirections.total > 1) {
                nextDirection = chooseDirection(validDirections);
            }
            switch (nextDirection) {
                case 'L':
                    currentX--;
                    break;
                case 'R':
                    currentX++;
                    break;
                case 'U':
                    currentY--;
                    break;
                case 'D':
                    currentY++;
                    break;
            }
            pathThusFar += nextDirection;
        }
    }

</script>
